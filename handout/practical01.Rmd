---
title: "ANOVA et comparaisons multiples"
output: 
  html_document:
    theme: default
    css: elements.css
    number_sections: false
    toc: true
    toc_float: true
    code_folding: show
    df_print: paged
---

Les paramètres suivants doivent être définis dans R ou RStudio afin de reproduire les analyses présentées dans ce document. Les packages **ggplot2** et **hrbrthemes** ne font pas partie de la distribution R et doivent être téléchargés au préalable (`install.packages(c("ggplot2", "hrbrthemes"))`) s'ils ne sont pas déjà installés. On supposera de plus que les instructions R sont exécutées dans un environnement de travail avec un répertoire `data/` disponible.
```{r, message = FALSE}
library(ggplot2)
library(hrbrthemes)
theme_set(theme_ipsum(base_size = 11))
```


# Rappels sur l'ANOVA à un facteur

## Chargement des données

## Description des variables

## Modélisation


# Modèle d'ANOVA à deux facteurs

## Chargement des données
On utilise les données sur le gain de poids chez des rats soumis à différents régimes alimentaires. Le chargement des données est réalisé ci-dessous :
```{r}
load("data/weight.rda")
str(weight)
```

## Description des variables

Les variables peuvent être décrites par colonnes mais il est préférable de réarranger le tableau sous forme de data frame, afin d'avoir une seule variable statistique par colonne :
```{r}
d <- data.frame(weight = as.numeric(unlist(weight)),
                type   = gl(2, 20, labels = c("Beef", "Cereal")),
                level  = gl(2, 10, labels = c("Low", "High")))
d
```

Voici un résumé graphique possible des données individuelles avec le package **ggplot2** : 
```{r}
p <- ggplot(data = d, aes(x = level, y = weight)) + 
       geom_boxplot(position = position_dodge()) +
       geom_jitter(size = .8, width = .05) +
       facet_wrap(~ type, nrow = 2) +
       labs(x = NULL, y = "Rat weight (g)")
p
```

## Modélisation

Le modèle d'ANOVA à deux facteurs avec interaction s'écrit :
```{r}
m <- aov(weight ~ type * level, data = d)
summary(m)
```

Le terme d'interaction n'étant pas significatif, il est possible de proposer un modèle plus simple :
```{r}
m <- aov(weight ~ type + level, data = d)
summary(m)
```

```{r}
t.test(weight ~ level, data = d, var.equal = TRUE)
```

## Exercices d'application {.tabset}

### ANOVA à deux facteurs


### Comparaisons post-hoc


### Spécification de contrastes
